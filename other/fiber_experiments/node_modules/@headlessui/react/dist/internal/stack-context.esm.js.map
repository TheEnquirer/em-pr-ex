{"version":3,"file":"stack-context.esm.js","sources":["../../src/internal/stack-context.tsx"],"sourcesContent":["import React, {\n  createContext,\n  useCallback,\n  useContext,\n\n  // Types\n  MutableRefObject,\n  ReactNode,\n} from 'react'\nimport { useIsoMorphicEffect } from '../hooks/use-iso-morphic-effect'\n\ntype OnUpdate = (\n  message: StackMessage,\n  type: string,\n  element: MutableRefObject<HTMLElement | null>\n) => void\n\nlet StackContext = createContext<OnUpdate>(() => {})\nStackContext.displayName = 'StackContext'\n\nexport enum StackMessage {\n  Add,\n  Remove,\n}\n\nexport function useStackContext() {\n  return useContext(StackContext)\n}\n\nexport function StackProvider({\n  children,\n  onUpdate,\n  type,\n  element,\n}: {\n  children: ReactNode\n  onUpdate?: OnUpdate\n  type: string\n  element: MutableRefObject<HTMLElement | null>\n}) {\n  let parentUpdate = useStackContext()\n\n  let notify = useCallback(\n    (...args: Parameters<OnUpdate>) => {\n      // Notify our layer\n      onUpdate?.(...args)\n\n      // Notify the parent\n      parentUpdate(...args)\n    },\n    [parentUpdate, onUpdate]\n  )\n\n  useIsoMorphicEffect(() => {\n    notify(StackMessage.Add, type, element)\n    return () => notify(StackMessage.Remove, type, element)\n  }, [notify, type, element])\n\n  return <StackContext.Provider value={notify}>{children}</StackContext.Provider>\n}\n"],"names":["StackContext","createContext","displayName","StackMessage","useStackContext","useContext","StackProvider","children","onUpdate","type","element","parentUpdate","notify","useCallback","args","useIsoMorphicEffect","Add","Remove","React","Provider","value"],"mappings":";;;AAiBA,IAAIA,YAAY,gBAAGC,aAAa,CAAW,cAAX,CAAhC;AACAD,YAAY,CAACE,WAAb,GAA2B,cAA3B;IAEYC;;AAAZ,WAAYA;AACVA,EAAAA,qCAAA,QAAA;AACAA,EAAAA,wCAAA,WAAA;AACD,CAHD,EAAYA,YAAY,KAAZA,YAAY,KAAA,CAAxB;;SAKgBC;AACd,SAAOC,UAAU,CAACL,YAAD,CAAjB;AACD;SAEeM;MACdC,gBAAAA;MACAC,gBAAAA;MACAC,YAAAA;MACAC,eAAAA;AAOA,MAAIC,YAAY,GAAGP,eAAe,EAAlC;AAEA,MAAIQ,MAAM,GAAGC,WAAW,CACtB;sCAAIC;AAAAA,MAAAA;;;AACF;AACAN,IAAAA,QAAQ,QAAR,YAAAA,QAAQ,MAAR,SAAcM,IAAd;;AAGAH,IAAAA,YAAY,MAAZ,SAAgBG,IAAhB;AACD,GAPqB,EAQtB,CAACH,YAAD,EAAeH,QAAf,CARsB,CAAxB;AAWAO,EAAAA,mBAAmB,CAAC;AAClBH,IAAAA,MAAM,CAACT,YAAY,CAACa,GAAd,EAAmBP,IAAnB,EAAyBC,OAAzB,CAAN;AACA,WAAO;AAAA,aAAME,MAAM,CAACT,YAAY,CAACc,MAAd,EAAsBR,IAAtB,EAA4BC,OAA5B,CAAZ;AAAA,KAAP;AACD,GAHkB,EAGhB,CAACE,MAAD,EAASH,IAAT,EAAeC,OAAf,CAHgB,CAAnB;AAKA,SAAOQ,mBAAA,CAAClB,YAAY,CAACmB,QAAd;AAAuBC,IAAAA,KAAK,EAAER;GAA9B,EAAuCL,QAAvC,CAAP;AACD;;;;"}