{"version":3,"file":"listbox.esm.js","sources":["../../../src/components/listbox/listbox.tsx"],"sourcesContent":["import React, {\n  Fragment,\n  createContext,\n  createRef,\n  useCallback,\n  useContext,\n  useMemo,\n  useReducer,\n  useRef,\n\n  // Types\n  Dispatch,\n  ElementType,\n  KeyboardEvent as ReactKeyboardEvent,\n  MouseEvent as ReactMouseEvent,\n  MutableRefObject,\n  Ref,\n} from 'react'\n\nimport { useDisposables } from '../../hooks/use-disposables'\nimport { useId } from '../../hooks/use-id'\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect'\nimport { useComputed } from '../../hooks/use-computed'\nimport { useSyncRefs } from '../../hooks/use-sync-refs'\nimport { Props } from '../../types'\nimport { Features, forwardRefWithAs, PropsForFeatures, render } from '../../utils/render'\nimport { match } from '../../utils/match'\nimport { disposables } from '../../utils/disposables'\nimport { Keys } from '../keyboard'\nimport { Focus, calculateActiveIndex } from '../../utils/calculate-active-index'\nimport { isDisabledReactIssue7711 } from '../../utils/bugs'\nimport { isFocusableElement, FocusableMode } from '../../utils/focus-management'\nimport { useWindowEvent } from '../../hooks/use-window-event'\nimport { useOpenClosed, State, OpenClosedProvider } from '../../internal/open-closed'\nimport { useResolveButtonType } from '../../hooks/use-resolve-button-type'\n\nenum ListboxStates {\n  Open,\n  Closed,\n}\n\ntype ListboxOptionDataRef = MutableRefObject<{\n  textValue?: string\n  disabled: boolean\n  value: unknown\n}>\n\ninterface StateDefinition {\n  listboxState: ListboxStates\n\n  orientation: 'horizontal' | 'vertical'\n\n  propsRef: MutableRefObject<{ value: unknown; onChange(value: unknown): void }>\n  labelRef: MutableRefObject<HTMLLabelElement | null>\n  buttonRef: MutableRefObject<HTMLButtonElement | null>\n  optionsRef: MutableRefObject<HTMLUListElement | null>\n\n  disabled: boolean\n  options: { id: string; dataRef: ListboxOptionDataRef }[]\n  searchQuery: string\n  activeOptionIndex: number | null\n}\n\nenum ActionTypes {\n  OpenListbox,\n  CloseListbox,\n\n  SetDisabled,\n  SetOrientation,\n\n  GoToOption,\n  Search,\n  ClearSearch,\n\n  RegisterOption,\n  UnregisterOption,\n}\n\ntype Actions =\n  | { type: ActionTypes.CloseListbox }\n  | { type: ActionTypes.OpenListbox }\n  | { type: ActionTypes.SetDisabled; disabled: boolean }\n  | { type: ActionTypes.SetOrientation; orientation: StateDefinition['orientation'] }\n  | { type: ActionTypes.GoToOption; focus: Focus.Specific; id: string }\n  | { type: ActionTypes.GoToOption; focus: Exclude<Focus, Focus.Specific> }\n  | { type: ActionTypes.Search; value: string }\n  | { type: ActionTypes.ClearSearch }\n  | { type: ActionTypes.RegisterOption; id: string; dataRef: ListboxOptionDataRef }\n  | { type: ActionTypes.UnregisterOption; id: string }\n\nlet reducers: {\n  [P in ActionTypes]: (\n    state: StateDefinition,\n    action: Extract<Actions, { type: P }>\n  ) => StateDefinition\n} = {\n  [ActionTypes.CloseListbox](state) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n    return { ...state, activeOptionIndex: null, listboxState: ListboxStates.Closed }\n  },\n  [ActionTypes.OpenListbox](state) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Open) return state\n    return { ...state, listboxState: ListboxStates.Open }\n  },\n  [ActionTypes.SetDisabled](state, action) {\n    if (state.disabled === action.disabled) return state\n    return { ...state, disabled: action.disabled }\n  },\n  [ActionTypes.SetOrientation](state, action) {\n    if (state.orientation === action.orientation) return state\n    return { ...state, orientation: action.orientation }\n  },\n  [ActionTypes.GoToOption](state, action) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n\n    let activeOptionIndex = calculateActiveIndex(action, {\n      resolveItems: () => state.options,\n      resolveActiveIndex: () => state.activeOptionIndex,\n      resolveId: item => item.id,\n      resolveDisabled: item => item.dataRef.current.disabled,\n    })\n\n    if (state.searchQuery === '' && state.activeOptionIndex === activeOptionIndex) return state\n    return { ...state, searchQuery: '', activeOptionIndex }\n  },\n  [ActionTypes.Search]: (state, action) => {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n\n    let searchQuery = state.searchQuery + action.value.toLowerCase()\n    let match = state.options.findIndex(\n      option =>\n        !option.dataRef.current.disabled &&\n        option.dataRef.current.textValue?.startsWith(searchQuery)\n    )\n\n    if (match === -1 || match === state.activeOptionIndex) return { ...state, searchQuery }\n    return { ...state, searchQuery, activeOptionIndex: match }\n  },\n  [ActionTypes.ClearSearch](state) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n    if (state.searchQuery === '') return state\n    return { ...state, searchQuery: '' }\n  },\n  [ActionTypes.RegisterOption]: (state, action) => ({\n    ...state,\n    options: [...state.options, { id: action.id, dataRef: action.dataRef }],\n  }),\n  [ActionTypes.UnregisterOption]: (state, action) => {\n    let nextOptions = state.options.slice()\n    let currentActiveOption =\n      state.activeOptionIndex !== null ? nextOptions[state.activeOptionIndex] : null\n\n    let idx = nextOptions.findIndex(a => a.id === action.id)\n\n    if (idx !== -1) nextOptions.splice(idx, 1)\n\n    return {\n      ...state,\n      options: nextOptions,\n      activeOptionIndex: (() => {\n        if (idx === state.activeOptionIndex) return null\n        if (currentActiveOption === null) return null\n\n        // If we removed the option before the actual active index, then it would be out of sync. To\n        // fix this, we will find the correct (new) index position.\n        return nextOptions.indexOf(currentActiveOption)\n      })(),\n    }\n  },\n}\n\nlet ListboxContext = createContext<[StateDefinition, Dispatch<Actions>] | null>(null)\nListboxContext.displayName = 'ListboxContext'\n\nfunction useListboxContext(component: string) {\n  let context = useContext(ListboxContext)\n  if (context === null) {\n    let err = new Error(`<${component} /> is missing a parent <${Listbox.name} /> component.`)\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useListboxContext)\n    throw err\n  }\n  return context\n}\n\nfunction stateReducer(state: StateDefinition, action: Actions) {\n  return match(action.type, reducers, state, action)\n}\n\n// ---\n\nlet DEFAULT_LISTBOX_TAG = Fragment\ninterface ListboxRenderPropArg {\n  open: boolean\n  disabled: boolean\n}\n\nexport function Listbox<TTag extends ElementType = typeof DEFAULT_LISTBOX_TAG, TType = string>(\n  props: Props<TTag, ListboxRenderPropArg, 'value' | 'onChange'> & {\n    value: TType\n    onChange(value: TType): void\n    disabled?: boolean\n    horizontal?: boolean\n  }\n) {\n  let { value, onChange, disabled = false, horizontal = false, ...passThroughProps } = props\n  const orientation = horizontal ? 'horizontal' : 'vertical'\n\n  let reducerBag = useReducer(stateReducer, {\n    listboxState: ListboxStates.Closed,\n    propsRef: { current: { value, onChange } },\n    labelRef: createRef(),\n    buttonRef: createRef(),\n    optionsRef: createRef(),\n    disabled,\n    orientation,\n    options: [],\n    searchQuery: '',\n    activeOptionIndex: null,\n  } as StateDefinition)\n  let [{ listboxState, propsRef, optionsRef, buttonRef }, dispatch] = reducerBag\n\n  useIsoMorphicEffect(() => {\n    propsRef.current.value = value\n  }, [value, propsRef])\n  useIsoMorphicEffect(() => {\n    propsRef.current.onChange = onChange\n  }, [onChange, propsRef])\n  useIsoMorphicEffect(() => dispatch({ type: ActionTypes.SetDisabled, disabled }), [disabled])\n  useIsoMorphicEffect(() => dispatch({ type: ActionTypes.SetOrientation, orientation }), [\n    orientation,\n  ])\n\n  // Handle outside click\n  useWindowEvent('mousedown', event => {\n    let target = event.target as HTMLElement\n\n    if (listboxState !== ListboxStates.Open) return\n\n    if (buttonRef.current?.contains(target)) return\n    if (optionsRef.current?.contains(target)) return\n\n    dispatch({ type: ActionTypes.CloseListbox })\n\n    if (!isFocusableElement(target, FocusableMode.Loose)) {\n      event.preventDefault()\n      buttonRef.current?.focus()\n    }\n  })\n\n  let slot = useMemo<ListboxRenderPropArg>(\n    () => ({ open: listboxState === ListboxStates.Open, disabled }),\n    [listboxState, disabled]\n  )\n\n  return (\n    <ListboxContext.Provider value={reducerBag}>\n      <OpenClosedProvider\n        value={match(listboxState, {\n          [ListboxStates.Open]: State.Open,\n          [ListboxStates.Closed]: State.Closed,\n        })}\n      >\n        {render({\n          props: passThroughProps,\n          slot,\n          defaultTag: DEFAULT_LISTBOX_TAG,\n          name: 'Listbox',\n        })}\n      </OpenClosedProvider>\n    </ListboxContext.Provider>\n  )\n}\n\n// ---\n\nlet DEFAULT_BUTTON_TAG = 'button' as const\ninterface ButtonRenderPropArg {\n  open: boolean\n  disabled: boolean\n}\ntype ButtonPropsWeControl =\n  | 'id'\n  | 'type'\n  | 'aria-haspopup'\n  | 'aria-controls'\n  | 'aria-expanded'\n  | 'aria-labelledby'\n  | 'disabled'\n  | 'onKeyDown'\n  | 'onClick'\n\nlet Button = forwardRefWithAs(function Button<TTag extends ElementType = typeof DEFAULT_BUTTON_TAG>(\n  props: Props<TTag, ButtonRenderPropArg, ButtonPropsWeControl>,\n  ref: Ref<HTMLButtonElement>\n) {\n  let [state, dispatch] = useListboxContext([Listbox.name, Button.name].join('.'))\n  let buttonRef = useSyncRefs(state.buttonRef, ref)\n\n  let id = `headlessui-listbox-button-${useId()}`\n  let d = useDisposables()\n\n  let handleKeyDown = useCallback(\n    (event: ReactKeyboardEvent<HTMLButtonElement>) => {\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n\n        case Keys.Space:\n        case Keys.Enter:\n        case Keys.ArrowDown:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenListbox })\n          d.nextFrame(() => {\n            if (!state.propsRef.current.value)\n              dispatch({ type: ActionTypes.GoToOption, focus: Focus.First })\n          })\n          break\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenListbox })\n          d.nextFrame(() => {\n            if (!state.propsRef.current.value)\n              dispatch({ type: ActionTypes.GoToOption, focus: Focus.Last })\n          })\n          break\n      }\n    },\n    [dispatch, state, d]\n  )\n\n  let handleKeyUp = useCallback((event: ReactKeyboardEvent<HTMLButtonElement>) => {\n    switch (event.key) {\n      case Keys.Space:\n        // Required for firefox, event.preventDefault() in handleKeyDown for\n        // the Space key doesn't cancel the handleKeyUp, which in turn\n        // triggers a *click*.\n        event.preventDefault()\n        break\n    }\n  }, [])\n\n  let handleClick = useCallback(\n    (event: ReactMouseEvent) => {\n      if (isDisabledReactIssue7711(event.currentTarget)) return event.preventDefault()\n      if (state.listboxState === ListboxStates.Open) {\n        dispatch({ type: ActionTypes.CloseListbox })\n        d.nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n      } else {\n        event.preventDefault()\n        dispatch({ type: ActionTypes.OpenListbox })\n      }\n    },\n    [dispatch, d, state]\n  )\n\n  let labelledby = useComputed(() => {\n    if (!state.labelRef.current) return undefined\n    return [state.labelRef.current.id, id].join(' ')\n  }, [state.labelRef.current, id])\n\n  let slot = useMemo<ButtonRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open, disabled: state.disabled }),\n    [state]\n  )\n  let passthroughProps = props\n  let propsWeControl = {\n    ref: buttonRef,\n    id,\n    type: useResolveButtonType(props, state.buttonRef),\n    'aria-haspopup': true,\n    'aria-controls': state.optionsRef.current?.id,\n    'aria-expanded': state.disabled ? undefined : state.listboxState === ListboxStates.Open,\n    'aria-labelledby': labelledby,\n    disabled: state.disabled,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    onClick: handleClick,\n  }\n\n  return render({\n    props: { ...passthroughProps, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_BUTTON_TAG,\n    name: 'Listbox.Button',\n  })\n})\n\n// ---\n\nlet DEFAULT_LABEL_TAG = 'label' as const\ninterface LabelRenderPropArg {\n  open: boolean\n  disabled: boolean\n}\ntype LabelPropsWeControl = 'id' | 'ref' | 'onClick'\n\nfunction Label<TTag extends ElementType = typeof DEFAULT_LABEL_TAG>(\n  props: Props<TTag, LabelRenderPropArg, LabelPropsWeControl>\n) {\n  let [state] = useListboxContext([Listbox.name, Label.name].join('.'))\n  let id = `headlessui-listbox-label-${useId()}`\n\n  let handleClick = useCallback(() => state.buttonRef.current?.focus({ preventScroll: true }), [\n    state.buttonRef,\n  ])\n\n  let slot = useMemo<LabelRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open, disabled: state.disabled }),\n    [state]\n  )\n  let propsWeControl = { ref: state.labelRef, id, onClick: handleClick }\n  return render({\n    props: { ...props, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_LABEL_TAG,\n    name: 'Listbox.Label',\n  })\n}\n\n// ---\n\nlet DEFAULT_OPTIONS_TAG = 'ul' as const\ninterface OptionsRenderPropArg {\n  open: boolean\n}\ntype OptionsPropsWeControl =\n  | 'aria-activedescendant'\n  | 'aria-labelledby'\n  | 'aria-orientation'\n  | 'id'\n  | 'onKeyDown'\n  | 'role'\n  | 'tabIndex'\n\nlet OptionsRenderFeatures = Features.RenderStrategy | Features.Static\n\nlet Options = forwardRefWithAs(function Options<\n  TTag extends ElementType = typeof DEFAULT_OPTIONS_TAG\n>(\n  props: Props<TTag, OptionsRenderPropArg, OptionsPropsWeControl> &\n    PropsForFeatures<typeof OptionsRenderFeatures>,\n  ref: Ref<HTMLUListElement>\n) {\n  let [state, dispatch] = useListboxContext([Listbox.name, Options.name].join('.'))\n  let optionsRef = useSyncRefs(state.optionsRef, ref)\n\n  let id = `headlessui-listbox-options-${useId()}`\n  let d = useDisposables()\n  let searchDisposables = useDisposables()\n\n  let usesOpenClosedState = useOpenClosed()\n  let visible = (() => {\n    if (usesOpenClosedState !== null) {\n      return usesOpenClosedState === State.Open\n    }\n\n    return state.listboxState === ListboxStates.Open\n  })()\n\n  useIsoMorphicEffect(() => {\n    let container = state.optionsRef.current\n    if (!container) return\n    if (state.listboxState !== ListboxStates.Open) return\n    if (container === document.activeElement) return\n\n    container.focus({ preventScroll: true })\n  }, [state.listboxState, state.optionsRef])\n\n  let handleKeyDown = useCallback(\n    (event: ReactKeyboardEvent<HTMLUListElement>) => {\n      searchDisposables.dispose()\n\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n\n        // @ts-expect-error Fallthrough is expected here\n        case Keys.Space:\n          if (state.searchQuery !== '') {\n            event.preventDefault()\n            event.stopPropagation()\n            return dispatch({ type: ActionTypes.Search, value: event.key })\n          }\n        // When in type ahead mode, fallthrough\n        case Keys.Enter:\n          event.preventDefault()\n          event.stopPropagation()\n          dispatch({ type: ActionTypes.CloseListbox })\n          if (state.activeOptionIndex !== null) {\n            let { dataRef } = state.options[state.activeOptionIndex]\n            state.propsRef.current.onChange(dataRef.current.value)\n          }\n          disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n          break\n\n        case match(state.orientation, { vertical: Keys.ArrowDown, horizontal: Keys.ArrowRight }):\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Next })\n\n        case match(state.orientation, { vertical: Keys.ArrowUp, horizontal: Keys.ArrowLeft }):\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Previous })\n\n        case Keys.Home:\n        case Keys.PageUp:\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.First })\n\n        case Keys.End:\n        case Keys.PageDown:\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Last })\n\n        case Keys.Escape:\n          event.preventDefault()\n          event.stopPropagation()\n          dispatch({ type: ActionTypes.CloseListbox })\n          return d.nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n\n        case Keys.Tab:\n          event.preventDefault()\n          event.stopPropagation()\n          break\n\n        default:\n          if (event.key.length === 1) {\n            dispatch({ type: ActionTypes.Search, value: event.key })\n            searchDisposables.setTimeout(() => dispatch({ type: ActionTypes.ClearSearch }), 350)\n          }\n          break\n      }\n    },\n    [d, dispatch, searchDisposables, state]\n  )\n\n  let labelledby = useComputed(() => state.labelRef.current?.id ?? state.buttonRef.current?.id, [\n    state.labelRef.current,\n    state.buttonRef.current,\n  ])\n\n  let slot = useMemo<OptionsRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open }),\n    [state]\n  )\n  let propsWeControl = {\n    'aria-activedescendant':\n      state.activeOptionIndex === null ? undefined : state.options[state.activeOptionIndex]?.id,\n    'aria-labelledby': labelledby,\n    'aria-orientation': state.orientation,\n    id,\n    onKeyDown: handleKeyDown,\n    role: 'listbox',\n    tabIndex: 0,\n    ref: optionsRef,\n  }\n  let passthroughProps = props\n\n  return render({\n    props: { ...passthroughProps, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_OPTIONS_TAG,\n    features: OptionsRenderFeatures,\n    visible,\n    name: 'Listbox.Options',\n  })\n})\n\n// ---\n\nlet DEFAULT_OPTION_TAG = 'li' as const\ninterface OptionRenderPropArg {\n  active: boolean\n  selected: boolean\n  disabled: boolean\n}\ntype ListboxOptionPropsWeControl =\n  | 'id'\n  | 'role'\n  | 'tabIndex'\n  | 'aria-disabled'\n  | 'aria-selected'\n  | 'onPointerLeave'\n  | 'onMouseLeave'\n  | 'onPointerMove'\n  | 'onMouseMove'\n  | 'onFocus'\n\nfunction Option<\n  TTag extends ElementType = typeof DEFAULT_OPTION_TAG,\n  // TODO: One day we will be able to infer this type from the generic in Listbox itself.\n  // But today is not that day..\n  TType = Parameters<typeof Listbox>[0]['value']\n>(\n  props: Props<TTag, OptionRenderPropArg, ListboxOptionPropsWeControl | 'value'> & {\n    disabled?: boolean\n    value: TType\n  }\n) {\n  let { disabled = false, value, ...passthroughProps } = props\n  let [state, dispatch] = useListboxContext([Listbox.name, Option.name].join('.'))\n  let id = `headlessui-listbox-option-${useId()}`\n  let active =\n    state.activeOptionIndex !== null ? state.options[state.activeOptionIndex].id === id : false\n  let selected = state.propsRef.current.value === value\n\n  let bag = useRef<ListboxOptionDataRef['current']>({ disabled, value })\n\n  useIsoMorphicEffect(() => {\n    bag.current.disabled = disabled\n  }, [bag, disabled])\n  useIsoMorphicEffect(() => {\n    bag.current.value = value\n  }, [bag, value])\n  useIsoMorphicEffect(() => {\n    bag.current.textValue = document.getElementById(id)?.textContent?.toLowerCase()\n  }, [bag, id])\n\n  let select = useCallback(() => state.propsRef.current.onChange(value), [state.propsRef, value])\n\n  useIsoMorphicEffect(() => {\n    dispatch({ type: ActionTypes.RegisterOption, id, dataRef: bag })\n    return () => dispatch({ type: ActionTypes.UnregisterOption, id })\n  }, [bag, id])\n\n  useIsoMorphicEffect(() => {\n    if (state.listboxState !== ListboxStates.Open) return\n    if (!selected) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n    document.getElementById(id)?.focus?.()\n  }, [state.listboxState])\n\n  useIsoMorphicEffect(() => {\n    if (state.listboxState !== ListboxStates.Open) return\n    if (!active) return\n    let d = disposables()\n    d.nextFrame(() => document.getElementById(id)?.scrollIntoView?.({ block: 'nearest' }))\n    return d.dispose\n  }, [id, active, state.listboxState])\n\n  let handleClick = useCallback(\n    (event: { preventDefault: Function }) => {\n      if (disabled) return event.preventDefault()\n      select()\n      dispatch({ type: ActionTypes.CloseListbox })\n      disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n    },\n    [dispatch, state.buttonRef, disabled, select]\n  )\n\n  let handleFocus = useCallback(() => {\n    if (disabled) return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Nothing })\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n  }, [disabled, id, dispatch])\n\n  let handleMove = useCallback(() => {\n    if (disabled) return\n    if (active) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n  }, [disabled, active, id, dispatch])\n\n  let handleLeave = useCallback(() => {\n    if (disabled) return\n    if (!active) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Nothing })\n  }, [disabled, active, dispatch])\n\n  let slot = useMemo<OptionRenderPropArg>(() => ({ active, selected, disabled }), [\n    active,\n    selected,\n    disabled,\n  ])\n  let propsWeControl = {\n    id,\n    role: 'option',\n    tabIndex: disabled === true ? undefined : -1,\n    'aria-disabled': disabled === true ? true : undefined,\n    'aria-selected': selected === true ? true : undefined,\n    disabled: undefined, // Never forward the `disabled` prop\n    onClick: handleClick,\n    onFocus: handleFocus,\n    onPointerMove: handleMove,\n    onMouseMove: handleMove,\n    onPointerLeave: handleLeave,\n    onMouseLeave: handleLeave,\n  }\n\n  return render({\n    props: { ...passthroughProps, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_OPTION_TAG,\n    name: 'Listbox.Option',\n  })\n}\n\n// ---\n\nListbox.Button = Button\nListbox.Label = Label\nListbox.Options = Options\nListbox.Option = Option\n"],"names":["ListboxStates","ActionTypes","reducers","CloseListbox","state","disabled","listboxState","Closed","activeOptionIndex","OpenListbox","Open","SetDisabled","action","SetOrientation","orientation","GoToOption","calculateActiveIndex","resolveItems","options","resolveActiveIndex","resolveId","item","id","resolveDisabled","dataRef","current","searchQuery","Search","value","toLowerCase","match","findIndex","option","textValue","startsWith","ClearSearch","RegisterOption","UnregisterOption","nextOptions","slice","currentActiveOption","idx","a","splice","indexOf","ListboxContext","createContext","displayName","useListboxContext","component","context","useContext","err","Error","Listbox","name","captureStackTrace","stateReducer","type","DEFAULT_LISTBOX_TAG","Fragment","props","onChange","horizontal","passThroughProps","reducerBag","useReducer","propsRef","labelRef","createRef","buttonRef","optionsRef","dispatch","useIsoMorphicEffect","useWindowEvent","event","target","contains","isFocusableElement","FocusableMode","Loose","preventDefault","focus","slot","useMemo","open","React","Provider","OpenClosedProvider","State","render","defaultTag","DEFAULT_BUTTON_TAG","Button","forwardRefWithAs","ref","join","useSyncRefs","useId","d","useDisposables","handleKeyDown","useCallback","key","Keys","Space","Enter","ArrowDown","nextFrame","Focus","First","ArrowUp","Last","handleKeyUp","handleClick","isDisabledReactIssue7711","currentTarget","preventScroll","labelledby","useComputed","undefined","passthroughProps","propsWeControl","useResolveButtonType","onKeyDown","onKeyUp","onClick","DEFAULT_LABEL_TAG","Label","DEFAULT_OPTIONS_TAG","OptionsRenderFeatures","Features","RenderStrategy","Static","Options","searchDisposables","usesOpenClosedState","useOpenClosed","visible","container","document","activeElement","dispose","stopPropagation","disposables","vertical","ArrowRight","Next","ArrowLeft","Previous","Home","PageUp","End","PageDown","Escape","Tab","length","setTimeout","role","tabIndex","features","DEFAULT_OPTION_TAG","Option","active","selected","bag","useRef","getElementById","textContent","select","Specific","scrollIntoView","block","handleFocus","Nothing","handleMove","handleLeave","onFocus","onPointerMove","onMouseMove","onPointerLeave","onMouseLeave"],"mappings":"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"}