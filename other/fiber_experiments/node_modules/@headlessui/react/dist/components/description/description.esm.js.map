{"version":3,"file":"description.esm.js","sources":["../../../src/components/description/description.tsx"],"sourcesContent":["import React, {\n  createContext,\n  useCallback,\n  useContext,\n  useMemo,\n  useState,\n\n  // Types\n  ElementType,\n  ReactNode,\n} from 'react'\n\nimport { Props } from '../../types'\nimport { useId } from '../../hooks/use-id'\nimport { render } from '../../utils/render'\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect'\n\n// ---\n\ninterface SharedData {\n  slot?: {}\n  name?: string\n  props?: {}\n}\n\nlet DescriptionContext = createContext<\n  ({ register(value: string): () => void } & SharedData) | null\n>(null)\n\nfunction useDescriptionContext() {\n  let context = useContext(DescriptionContext)\n  if (context === null) {\n    let err = new Error(\n      'You used a <Description /> component, but it is not inside a relevant parent.'\n    )\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useDescriptionContext)\n    throw err\n  }\n  return context\n}\n\ninterface DescriptionProviderProps extends SharedData {\n  children: ReactNode\n}\n\nexport function useDescriptions(): [\n  string | undefined,\n  (props: DescriptionProviderProps) => JSX.Element\n] {\n  let [descriptionIds, setDescriptionIds] = useState<string[]>([])\n\n  return [\n    // The actual id's as string or undefined\n    descriptionIds.length > 0 ? descriptionIds.join(' ') : undefined,\n\n    // The provider component\n    useMemo(() => {\n      return function DescriptionProvider(props: DescriptionProviderProps) {\n        let register = useCallback((value: string) => {\n          setDescriptionIds(existing => [...existing, value])\n\n          return () =>\n            setDescriptionIds(existing => {\n              let clone = existing.slice()\n              let idx = clone.indexOf(value)\n              if (idx !== -1) clone.splice(idx, 1)\n              return clone\n            })\n        }, [])\n\n        let contextBag = useMemo(\n          () => ({ register, slot: props.slot, name: props.name, props: props.props }),\n          [register, props.slot, props.name, props.props]\n        )\n\n        return (\n          <DescriptionContext.Provider value={contextBag}>\n            {props.children}\n          </DescriptionContext.Provider>\n        )\n      }\n    }, [setDescriptionIds]),\n  ]\n}\n\n// ---\n\nlet DEFAULT_DESCRIPTION_TAG = 'p' as const\ninterface DescriptionRenderPropArg {}\ntype DescriptionPropsWeControl = 'id'\n\nexport function Description<TTag extends ElementType = typeof DEFAULT_DESCRIPTION_TAG>(\n  props: Props<TTag, DescriptionRenderPropArg, DescriptionPropsWeControl>\n) {\n  let context = useDescriptionContext()\n  let id = `headlessui-description-${useId()}`\n\n  useIsoMorphicEffect(() => context.register(id), [id, context.register])\n\n  let passThroughProps = props\n  let propsWeControl = { ...context.props, id }\n\n  return render({\n    props: { ...passThroughProps, ...propsWeControl },\n    slot: context.slot || {},\n    defaultTag: DEFAULT_DESCRIPTION_TAG,\n    name: context.name || 'Description',\n  })\n}\n"],"names":["DescriptionContext","createContext","useDescriptionContext","context","useContext","err","Error","captureStackTrace","useDescriptions","useState","descriptionIds","setDescriptionIds","length","join","undefined","useMemo","DescriptionProvider","props","register","useCallback","value","existing","clone","slice","idx","indexOf","splice","contextBag","slot","name","React","Provider","children","DEFAULT_DESCRIPTION_TAG","Description","id","useId","useIsoMorphicEffect","passThroughProps","propsWeControl","render","defaultTag"],"mappings":";;;;;;AAyBA,IAAIA,kBAAkB,gBAAGC,aAAa,CAEpC,IAFoC,CAAtC;;AAIA,SAASC,qBAAT;AACE,MAAIC,OAAO,GAAGC,UAAU,CAACJ,kBAAD,CAAxB;;AACA,MAAIG,OAAO,KAAK,IAAhB,EAAsB;AACpB,QAAIE,GAAG,GAAG,IAAIC,KAAJ,CACR,+EADQ,CAAV;AAGA,QAAIA,KAAK,CAACC,iBAAV,EAA6BD,KAAK,CAACC,iBAAN,CAAwBF,GAAxB,EAA6BH,qBAA7B;AAC7B,UAAMG,GAAN;AACD;;AACD,SAAOF,OAAP;AACD;;SAMeK;kBAI4BC,QAAQ,CAAW,EAAX;MAA7CC;MAAgBC;;AAErB,SAAO;AAELD,EAAAA,cAAc,CAACE,MAAf,GAAwB,CAAxB,GAA4BF,cAAc,CAACG,IAAf,CAAoB,GAApB,CAA5B,GAAuDC,SAFlD;AAKLC,EAAAA,OAAO,CAAC;AACN,WAAO,SAASC,mBAAT,CAA6BC,KAA7B;AACL,UAAIC,QAAQ,GAAGC,WAAW,CAAC,UAACC,KAAD;AACzBT,QAAAA,iBAAiB,CAAC,UAAAU,QAAQ;AAAA,2BAAQA,QAAR,GAAkBD,KAAlB;AAAA,SAAT,CAAjB;AAEA,eAAO;AAAA,iBACLT,iBAAiB,CAAC,UAAAU,QAAQ;AACxB,gBAAIC,KAAK,GAAGD,QAAQ,CAACE,KAAT,EAAZ;AACA,gBAAIC,GAAG,GAAGF,KAAK,CAACG,OAAN,CAAcL,KAAd,CAAV;AACA,gBAAII,GAAG,KAAK,CAAC,CAAb,EAAgBF,KAAK,CAACI,MAAN,CAAaF,GAAb,EAAkB,CAAlB;AAChB,mBAAOF,KAAP;AACD,WALgB,CADZ;AAAA,SAAP;AAOD,OAVyB,EAUvB,EAVuB,CAA1B;AAYA,UAAIK,UAAU,GAAGZ,OAAO,CACtB;AAAA,eAAO;AAAEG,UAAAA,QAAQ,EAARA,QAAF;AAAYU,UAAAA,IAAI,EAAEX,KAAK,CAACW,IAAxB;AAA8BC,UAAAA,IAAI,EAAEZ,KAAK,CAACY,IAA1C;AAAgDZ,UAAAA,KAAK,EAAEA,KAAK,CAACA;AAA7D,SAAP;AAAA,OADsB,EAEtB,CAACC,QAAD,EAAWD,KAAK,CAACW,IAAjB,EAAuBX,KAAK,CAACY,IAA7B,EAAmCZ,KAAK,CAACA,KAAzC,CAFsB,CAAxB;AAKA,aACEa,mBAAA,CAAC9B,kBAAkB,CAAC+B,QAApB;AAA6BX,QAAAA,KAAK,EAAEO;OAApC,EACGV,KAAK,CAACe,QADT,CADF;AAKD,KAvBD;AAwBD,GAzBM,EAyBJ,CAACrB,iBAAD,CAzBI,CALF,CAAP;AAgCD;;AAID,IAAIsB,uBAAuB,GAAG,GAA9B;SAIgBC,YACdjB;AAEA,MAAId,OAAO,GAAGD,qBAAqB,EAAnC;AACA,MAAIiC,EAAE,+BAA6BC,KAAK,EAAxC;AAEAC,EAAAA,mBAAmB,CAAC;AAAA,WAAMlC,OAAO,CAACe,QAAR,CAAiBiB,EAAjB,CAAN;AAAA,GAAD,EAA6B,CAACA,EAAD,EAAKhC,OAAO,CAACe,QAAb,CAA7B,CAAnB;AAEA,MAAIoB,gBAAgB,GAAGrB,KAAvB;;AACA,MAAIsB,cAAc,gBAAQpC,OAAO,CAACc,KAAhB;AAAuBkB,IAAAA,EAAE,EAAFA;AAAvB,IAAlB;;AAEA,SAAOK,MAAM,CAAC;AACZvB,IAAAA,KAAK,eAAOqB,gBAAP,EAA4BC,cAA5B,CADO;AAEZX,IAAAA,IAAI,EAAEzB,OAAO,CAACyB,IAAR,IAAgB,EAFV;AAGZa,IAAAA,UAAU,EAAER,uBAHA;AAIZJ,IAAAA,IAAI,EAAE1B,OAAO,CAAC0B,IAAR,IAAgB;AAJV,GAAD,CAAb;AAMD;;;;"}